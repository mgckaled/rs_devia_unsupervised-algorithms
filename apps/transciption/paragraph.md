Para a gente agora concluir o módulo, a gente vai desenvolver, dentro do Gradle, uma aplicação simples. A gente até já fez uma aplicação parecida, mas a gente vai ter umas nuances aqui de que a gente vai transformar os dados em um pipeline separado. A gente não vai ter predict, na verdade, porque o nosso modelo não faz predições. Ele está, na verdade, trazendo uma estrutura com um algoritmo não supervisionado. E a gente vai popular essa coluna dentro de um arquivo e devolver esse arquivo para o usuário nessa aplicação. A gente vai fazer tudo isso no Gradle, portanto é só a gente criar uma célula separada para isso, com todas as informações. Vou colocar aqui a aplicação Batch no Gradle. Vou colocar aqui em Python. Vou colocar aqui Import Gradle as GR. Vou importar o modelo. Apesar do modelo já estar lá, mas eu vou importar ele, imaginando que isso aqui fosse uma aplicação separada. E vou carregar esse modelo. .modelo-clusterização-de-clientes.pkl E vou instanciar o preprocessor. Aqui ele vai ser o joblib.load.barra-pipeline-clusterização-de-clientes.pkl A primeira coisa que eu preciso fazer é eu definir uma função, que vai ser a função que vai ser chamada pelo front-end. Essa função eu vou chamar de clustering, onde ela recebe um arquivo. Esse arquivo vai ser lido, então eu vou colocar aqui df-empresas igual a pd.read.csv, um arquivo CSV que eu vou receber. Eu vou ler o arquivo .name, nome do arquivo que vai vir aqui do que o usuário estiver fazendo o upload. Preciso transformar os dados, então aqui eu vou fazer, só colocar aqui a observação. Carregar o CSV em um DataFrame. Transformar os dados do DataFrame para o formato que o Caminhos precisa, que é o pré-processamento. Então eu vou colocar aqui um xtransformed é igual a preprocessor.fit.transform do df-empresas direto. Não preciso fazer um copy de x, já estou fazendo direto do DataFrame. Vou treinar o modelo, então vou colocar aqui modelo.fit do xtransformed. Retornei o modelo, eu preciso colocar no arquivo, no DataFrame, a coluna de cluster. Então aqui eu vou criar a coluna cluster no DataFrame. Então vou colocar aqui df-empresas, vou usar o mesmo DataFrame, coluna cluster, que é igual a modelo.labels, underline. E vou salvar esse DataFrame, vou dar um to CSV, como um CSV. Esse CSV vai se chamar .barraclusters.csv e não vou salvar ele com índice, então índice igual a falso. E o que eu vou retornar na minha aplicação é justamente um arquivo. Então vou dar um return e vou colocar como retorno o nome desse arquivo que eu estou gerando, .barraclusters.csv. Então até aqui eu fiz a função que faz a chamada do Caminhos. E agora eu preciso só criar a interface para chamar. Então eu vou salvar isso aqui, vou rodar isso aqui. Ele já criou a função, subiu o modelo. Agora eu posso criar a interface. Aqui é criar a interface. Vou chamá-la aqui de aplicação igual a gr.interface, é uma interface do Gradle. O que vai ter nessa interface? Vai ter a função que eu chamo, é a função chamada clustering. E ela vai ter um parâmetro que é um tipo de dado, um tipo de input chamado file, que é para você fazer upload de arquivo. Onde eu só vou aceitar arquivos do tipo CSV. E ele vai me retornar um tipo de dado que também é um arquivo. Vou colocar aqui como file. Feito isso, vou rodar a aplicação. Para rodar a aplicação a gente dá um app.launch Está rodando o local, abriu aqui. Então a gente tem agora uma caixinha para subir um arquivo e ele vai jogar o arquivo de saída com o cluster. E a gente pode baixar esse arquivo. Então se eu clicar aqui, eu posso vir aqui em projetos, vou pegar o arquivo que está aqui. Eu vou pegar o próprio dataset completo, vou pegar o mesmo dataset. Então está aqui dataset client.pj. Vou dar um submit e ele gerou um outro arquivo chamado clusters.csv. Se eu vir aqui nesse clusters.csv e clicar e falar para ele baixar. Vou pedir para ele baixar isso daqui. Vou jogar aqui no meu downloads mesmo, tudo bem. Já tem um aqui, pronto. Se eu vir aqui em clusters e abrir isso aqui no meu sublime. Só fazer isso aqui, pronto. Está aqui. As colunas que já tinham o arquivo mais a coluna cluster e ele colocou aqui o cluster nessa coluna. Então a gente conseguiu finalizar essa parte. A gente criou uma aplicação batch que sobe um arquivo, ele devolve um arquivo, eu faço download e ele está ali com a classificação. Então com isso a gente fecha mais um módulo, nossa trilha de IA. Dessa vez dedicada a algoritmos supervisionados de clusterização. Onde a gente começou com o Kamins. Espero que vocês tenham gostado dos módulos e vejo vocês no próximo módulo.